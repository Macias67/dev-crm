<h3 class = "page-title"> {{vista.titulo}}
	<small>{{vista.subtitulo}}</small>
</h3>

<div class = "page-bar">
	<ul class = "page-breadcrumb">
		<li>
			<i class = "fa fa-home"></i>
			<a href = "#/dashboard">Inicio</a>
			<i class = "fa fa-angle-right"></i>
		</li>
		<li>
			<a href = "#">Blank Page</a>
			<i class = "fa fa-angle-right"></i>
		</li>
		<li>
			<span>Page Layouts</span>
		</li>
	</ul>
	<div class = "page-toolbar">
		<div class = "btn-group pull-right">
			<button type = "button" class = "btn btn-fit-height grey-salt dropdown-toggle" data-toggle = "dropdown" data-hover = "dropdown" data-delay = "1000" data-close-others = "true"> Actions
				<i class = "fa fa-angle-down"></i>
			</button>
			<ul class = "dropdown-menu pull-right" role = "menu">
				<li>
					<a href = "#">
						<i class = "icon-bell"></i>
					</a>
				</li>
				<li>
					<a href = "#">
						<i class = "icon-shield"></i> Another action
					</a>
				</li>
				<li>
					<a href = "#">
						<i class = "icon-user"></i> Something else here
					</a>
				</li>
				<li class = "divider"> </li>
				<li>
					<a href = "#">
						<i class = "icon-bag"></i> Separated link
					</a>
				</li>
			</ul>
		</div>
	</div>
</div>

<div class = "row">
	<div class = "col-md-12">
		<div class = "alert alert-danger">
			<strong>¡Faltan datos por asignar!</strong>
			Antes de continuar, debes establecer fecha de inicio de la tarea, tiempo de duración aproximada y fecha de cierre tentativo. Haz clic <a href = "javascript:;" ng-click = "gestionTareaCtrl.modalAsignaFechas()" class = "alert-link">aquí</a> para hacerlo.
		</div>
		<div class = "alert alert-danger">
			<strong>¡Vas atrasado!</strong> La fecha tentativa de cierre del caso ya pasó, procura terminar la tarea lo más pronto posible.
		</div>
		<div class = "alert alert-info alert-dismissable">
			<button type = "button" class = "close" data-dismiss = "alert" aria-hidden = "true"></button>
			<strong>Última tarea del caso. </strong> Esta es última tarea del caso por concluir, procura terminar dentro de tus fechas establecidas.
		</div>
	</div>
	<div class = "col-md-8">
		<div class = "portlet mt-element-ribbon light portlet-fit">
			<div class = "ribbon ribbon-right ribbon-clip ribbon-shadow ribbon-border-dash-hor bg-font-{{gestionTareaCtrl.tarea.estatus.class}} uppercase">
				<div class = "ribbon-sub ribbon-clip ribbon-right" ng-style = "{'background-color': gestionTareaCtrl.tarea.estatus.color}"></div>
				<b>{{gestionTareaCtrl.tarea.estatus.estatus}}</b>
			</div>
			<div class = "portlet-title">
				<div class = "caption">
					<i class = "icon-puzzle font-grey-gallery"></i>
					<span class = "caption-subject bold font-grey-gallery uppercase"> Tarea </span>
					<span class = "caption-helper">Actividad a realizar</span>
				</div>
			</div>
			<div class = "portlet-body">
				<h4 class = "bold uppercase">{{gestionTareaCtrl.tarea.id+'.- '+gestionTareaCtrl.tarea.titulo}}</h4>
				<p class = "lead">{{gestionTareaCtrl.tarea.descripcion}}</p>
				<hr>
				<div class = "progress progress-striped active">
					<div class = "progress-bar progress-bar-success" role = "progressbar" aria-valuenow = "40" aria-valuemin = "0" aria-valuemax = "100" style = "width: 40%">
						<span class = "sr-only"> 40% Complete (success) </span>
					</div>
				</div>
			</div>
		</div>
		<div class = "col-md-5">
			<div class = "portlet light">
				<div class = "portlet-title">
					<div class = "caption">
					<i class = "icon-puzzle font-grey-gallery"></i>
					<span class = "caption-subject bold font-grey-gallery uppercase"> Registro de tiempos</span>
					</div>
				</div>
				<div class = "portlet-body">
					<button class = "btn green-jungle btn-block btn-lg uppercase bold">
						<i class = "fa fa-play"></i>&nbsp;&nbsp;Trabajar en la tarea
					</button>
					<hr>
					<table class = "table table-hover table-light">
						<thead>
							<tr class = "uppercase">
								<th> # </th>
								<th> Fecha </th>
								<th> Duración </th>
							</tr>
						</thead>
						<tbody>
							<tr>
								<td> 1 </td>
								<td> 23 de sept. 2016  a las 4:58 pm</td>
								<td> 3:00 hras</td>
							</tr>
							<tr>
								<td> 2 </td>
								<td> 24 de sept. 2016  a las 2:08 pm</td>
								<td> 1:30 hras</td>
							</tr>
						</tbody>
					</table>
					<hr>
					<h4 class = "uppercase">Duración total: <b>4:30 hras</b></h4>
				</div>
			</div>
		</div>
		<div class = "col-md-7">
			<div class = "portlet light">
				<div class = "portlet-title">
					<div class = "caption">
					<i class = "icon-puzzle font-grey-gallery"></i>
					<span class = "caption-subject bold font-grey-gallery uppercase"> Bitácora de eventos</span>
					</div>
				</div>
				<div class = "portlet-body">
					<form role = "form" name = "gestionTareaCtrl.notas.formNotas">
						<div class = "form-body">
							<div class = "form-group">
								<textarea class = "form-control" rows = "3" placeholder = "Descripción de la nota" ng-model = "gestionTareaCtrl.notas.form.descripcion" required></textarea>
							</div>
						</div>
						<div class = "form-group">
							<div class = "mt-radio-inline" style = "padding: 0px">
								<label class = "mt-radio">
									<input type = "radio" name = "tipoNota" id = "tipoNota1" value = "1" checked = "" ng-model = "gestionTareaCtrl.notas.form.tipo" ng-required = "true"> Pública
									<span></span>
								</label>
								<label class = "mt-radio">
									<input type = "radio" name = "tipoNota" id = "tipoNota2" value = "0" ng-model = "gestionTareaCtrl.notas.form.tipo" ng-required = "true"> Privada
									<span></span>
								</label>
							</div>
						</div>
						<div class = "form-group">
							<input type = "file" ngf-select ng-model = "gestionTareaCtrl.notas.form.file" name = "file" accept = "image/*" ngf-max-size = "2MB" ngf-model-invalid = "errorFile">
							<p class = "help-block"> Tamaño max. de archivo 5MB.  </p>
							<div class = "progress progress-striped" ng-show = "gestionTareaCtrl.notas.form.file != null">
								<div class = "progress-bar progress-bar-info" role = "progressbar" aria-valuenow = "{{gestionTareaCtrl.notas.progress}}" aria-valuemin = "0" aria-valuemax = "100" ng-style = "{width: gestionTareaCtrl.notas.progress+'%'}">
									<span class = "sr-only"> {{gestionTareaCtrl.notas.progress}}% Complete </span>
								</div>
							</div>
						</div>
						<div class = "form-group">
							<button class = "btn green-jungle btn-xs" ladda = "gestionTareaCtrl.notas.loading" data-style = "expand-right" ng-click = "gestionTareaCtrl.notas.guarda()" ng-disabled = "!gestionTareaCtrl.notas.formNotas.$valid">
								<b><i class = "fa fa-plus"></i>  Añade nota</b>
							</button>
						</div>
					</form>
					<hr>
					<ul class = "nav nav-tabs">
						<li class = "active">
							<a href = "#todas" target = "_self" data-toggle = "tab"> Todas </a>
						</li>
						<li>
							<a href = "#publicas" target = "_self" data-toggle = "tab"> Públicas </a>
						</li>
						<li>
							<a href = "#privadas" target = "_self" data-toggle = "tab"> Privadas </a>
						</li>
					</ul>
					<div class = "tab-content">
						<div class = "tab-pane fade active in" id = "todas">
							<ul class = "list-group">
								<li class = "list-group-item" ng-repeat = "nota in gestionTareaCtrl.tarea.notas.todas">
									<h6 class = "help-block font-green-turquoise"><i class = "fa fa-check-circle-o"></i> Visto por el cliente. </h6>
									<p>{{nota.nota}} </p>
									<h6 class = "bold font-grey-mint"><i class = "fa fa-calendar"></i> {{nota.creada | amUtc | amDateFormat:'DD [de] MMMM [del] YYYY [a las] hh:mm:ss A'}}</h6>
									<h6 ng-show = "nota.publico">
										<span class = "label label-primary"><b>Pública</b></span>
									</h6>
									<h6 ng-show = "!nota.publico">
										<span class = "label label-danger"> <b>Privada</b></span>
									</h6>
									<hr>
									<h6>Archivos adjuntos:</h6>
									<ul>
										<li> Lorem ipsum dolor sit amet </li>
									</ul>
								</li>
							</ul>
						</div>
						<div class = "tab-pane fade" id = "publicas">
							<ul class = "list-group">
								<li class = "list-group-item" ng-repeat = "nota in gestionTareaCtrl.tarea.notas.publicas">
									<h6 class = "help-block font-green-turquoise"> <i class = "fa fa-check-circle-o"></i> Visto por el cliente. </h6>
									<p>{{nota.nota}} </p>
									<h6 class = "bold font-grey-mint"><i class = "fa fa-calendar"></i> {{nota.creada | amUtc | amDateFormat:'DD [de] MMMM [del] YYYY [a las] hh:mm:ss A'}}</h6>
									<h6 ng-show = "nota.publico"><span class = "label label-primary"> <b>Pública</b> </span></h6>
									<hr>
									<h6>Archivos adjuntos:</h6>
									<ul>
										<li> Lorem ipsum dolor sit amet </li>
									</ul>
								</li>
							</ul>
						</div>
						<div class = "tab-pane fade" id = "privadas">
							<ul class = "list-group">
								<li class = "list-group-item" ng-repeat = "nota in gestionTareaCtrl.tarea.notas.privadas">
									<h6 class = "help-block font-green-turquoise"> <i class = "fa fa-check-circle-o"></i> Visto por el cliente. </h6>
									<p>{{nota.nota}} </p>
									<h6 class = "bold font-grey-mint"><i class = "fa fa-calendar"></i> {{nota.creada | amUtc | amDateFormat:'DD [de] MMMM [del] YYYY [a las] hh:mm:ss A'}}</h6>
									<h6 ng-show = "!nota.publico"><span class = "label label-danger"> <b>Privada</b> </span></h6>
									<hr>
									<h6>Archivos adjuntos:</h6>
									<ul>
										<li> Lorem ipsum dolor sit amet </li>
									</ul>
								</li>
							</ul>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class = "col-md-4">
		<div class = "portlet light">
			<div class = "portlet-title">
				<div class = "caption">
					<i class = "fa fa-calendar font-grey-gallery"></i>
					<span class = "caption-subject bold font-grey-gallery uppercase"> Fechas programadas</span>
				</div>
			</div>
			<div class = "portlet-body">
				<div class="form-group">
					<label>Fecha de inicio: </label>
					<div class="input-group input-group-sm">
						<input type="text" class="form-control"
						       datetime-picker="dd/MM/yyyy HH:mm"
						       ng-model="gestionTareaCtrl.fechatarea.fechainicio"
						       is-open="gestionTareaCtrl.fechainicio.open"
						       placeholder="Fecha de inicio" readonly/>
						<span class="input-group-btn">
							<button class="btn green bold" type="button" ng-click="gestionTareaCtrl.fechainicio.openCalendar()">
								<i class="fa fa-calendar"></i>
							</button>
						</span>
					</div>
				</div>
				<div class="form-group">
					<label>Duración en horas: </label>
					<div class="input-icon input-icon-sm right">
						<i class="fa fa-clock-o"></i>
						<input type="text" class="form-control input-sm" ng-model="gestionTareaCtrl.fechatarea.duracion" placeholder="00:00" mask = "9?9:99" restrict = "reject" validate = "false">
					</div>
				</div>
				<div class="form-group">
					<label>Fecha tentativa de cierre: </label>
					<div class="input-group input-group-sm">
						<input type="text" class="form-control"
						       datetime-picker="dd/MM/yyyy"
						       ng-model="gestionTareaCtrl.fechatarea.fechacierre"
						       is-open="gestionTareaCtrl.fechacierre.open"
						       placeholder="Fecha de inicio" readonly/>
						<span class="input-group-btn">
							<button class="btn green bold" type="button" ng-click="gestionTareaCtrl.fechacierre.openCalendar()">
								<i class="fa fa-calendar"></i>
							</button>
						</span>
					</div>
				</div>
				<button class = "btn blue btn-block">Fecha de inicio</button>
			</div>
		</div>
		<div class = "portlet light">
			<div class = "portlet-title">
				<div class = "caption">
					<i class = "icon-puzzle font-grey-gallery"></i>
					<span class = "caption-subject bold font-grey-gallery uppercase"> Caso No. {{gestionTareaCtrl.caso.id}}</span>
				</div>
				<div class = "actions">
					<button class = "btn btn-circle btn-icon-only btn-default" ng-click = "gestionTareaCtrl.reloadCaso()">
						<i class = "fa fa-refresh"></i>
					</button>
					<a class = "btn btn-circle btn-icon-only btn-default fullscreen" href = "javascript:;" data-original-title = "" title = ""> </a>
				</div>
			</div>
			<div class = "portlet-body">
				<div class = "row">
					<div class = "col-md-12">
						<dt>Cliente</dt>
						<dd>{{gestionTareaCtrl.caso.cliente.razonsocial}}</dd>
						<br>
						<dt>Contacto</dt>
						<dd>{{gestionTareaCtrl.caso.cotizacion.contacto.nombre}}</dd>
						<dd>{{gestionTareaCtrl.caso.cotizacion.contacto.email}}</dd>
						<dd>{{gestionTareaCtrl.caso.cotizacion.contacto.telefono | telefono}}</dd>
					</div>
				</div>
				<br>
				<div class = "row">
					<div class = "col-md-4">
						<dt>Lider</dt>
						<dd>{{gestionTareaCtrl.caso.lider.nombre}}</dd>
					</div>
					<div class = "col-md-4">
						<dt>Avance</dt>
						<dd>{{gestionTareaCtrl.caso.avance}} %</dd>
					</div>
					<div class = "col-md-4">
						<dt>Estatus</dt>
						<span class = "badge bg-{{gestionTareaCtrl.caso.estatus.class}} bold"> {{gestionTareaCtrl.caso.estatus.estatus}} </span>
					</div>
				</div>
				<br>
				<div class = "row">
					<div class = "col-md-12">
						<dt>Fecha tentativa de cierre: </dt>
						<dd ng-if = "gestionTareaCtrl.caso.fechatentativacierre == null">Aún sin calcularse.</dd>
						<dd ng-if = "gestionTareaCtrl.caso.fechatentativacierre != null">{{gestionTareaCtrl.caso.lider.nombre}}</dd>
					</div>
				</div>
				<hr>
				<div class = "row">
					<div class = "col-md-12">
						<h5 class = "bold">Tareas:</h5>
						<ul class = "list-group">
							<li class = "list-group-item" ng-repeat = "tarea in gestionTareaCtrl.caso.tareas" ng-class = "{'bg-grey-steel bg-font-grey-steel': tarea.id == gestionTareaCtrl.tarea.id}">
								<b>{{tarea.titulo}}</b><br>
								 <span>{{tarea.ejecutivo.nombre}}</span>
								<span class = "badge bg-{{tarea.ejecutivo.class}}"> <b>{{(tarea.avance)}} %</b> </span>
							</li>
						</ul>
					</div>
				</div>
				<hr>
				<button class = "btn blue btn-block" ng-click = "gestionTareaCtrl.vistaCaso()"><b>Vista del caso</b></button>
			</div>
		</div>
	</div>
</div>

<script type = "text/ng-template" id = "modalAsignaFechas.html">
	<div class = "modal-header">
		<button type = "button" class = "close" aria-hidden = "true" ng-click = "modalAsignaFechas.cancel()"></button>
		<h4 class = "modal-title font-green-sharp"><i class = "fa fa-truck"></i> Nuevo producto </h4>
	</div>
	<div class = "modal-body form">
		<div class = "col-md-6">
			<form role = "form" name = "modalAsignaFechas.formFechas">
				<div class = "form-body">
					<div class = "form-group">
						<input type = "text" class = "form-control" datetime-picker = "dd MMM yyyy HH:mm" ng-model = "myDate" is-open = "isOpen"/>
						<span class = "input-group-btn">
							<button type = "button" class = "btn btn-default" ng-click = "openCalendar($event, prop)"><i class = "fa fa-calendar"></i></button>
						</span>
					</div>
				</div>
			</form>
			{{modalAsignaFechas.form | json}}
		</div>
		<div class = "col-md-6"></div>
		<div class = "clearfix"></div>
	</div>
	<div class = "modal-footer">
		<button class = "btn green-jungle btn-outline sbold uppercase"
		        ng-click = "modalAsignaFechas.guarda()"
		        ng-disabled = "!modalAsignaFechas.formFechas.$valid">
			Guardar
		</button>
		<button class = "btn grey-mint btn-outline" ng-click = "modalAsignaFechas.cancel()">Cancelar</button>
	</div>
</script>