<h3 class = "page-title"> {{vista.titulo}}
	<small>{{vista.subtitulo}}</small>
</h3>

<div class = "page-bar">
	<ul class = "page-breadcrumb">
		<li>
			<i class = "fa fa-home"></i>
			<a href = "#/dashboard">Inicio</a>
			<i class = "fa fa-angle-right"></i>
		</li>
		<li>
			<a href = "#">Blank Page</a>
			<i class = "fa fa-angle-right"></i>
		</li>
		<li>
			<span>Page Layouts</span>
		</li>
	</ul>
	<div class = "page-toolbar">
		<div class = "btn-group pull-right">
			<button type = "button" class = "btn btn-fit-height grey-salt dropdown-toggle" data-toggle = "dropdown" data-hover = "dropdown" data-delay = "1000" data-close-others = "true"> Actions
				<i class = "fa fa-angle-down"></i>
			</button>
			<ul class = "dropdown-menu pull-right" role = "menu">
				<li>
					<a href = "#">
						<i class = "icon-bell"></i>
					</a>
				</li>
				<li>
					<a href = "#">
						<i class = "icon-shield"></i> Another action
					</a>
				</li>
				<li>
					<a href = "#">
						<i class = "icon-user"></i> Something else here
					</a>
				</li>
				<li class = "divider"> </li>
				<li>
					<a href = "#">
						<i class = "icon-bag"></i> Separated link
					</a>
				</li>
			</ul>
		</div>
	</div>
</div>

<div class = "row">
	<div class = "col-md-12">
		<div class = "alert bg-yellow-mint bg-font-yellow-mint" ng-show = "gestionTareaCtrl.avisos.reasignado()">
			<strong>Tarea reasignada.</strong>
			Esta tarea se te ha reasginado por este motivo: <i class = "bold">{{gestionTareaCtrl.tarea.reasignaciones[0].motivo}}</i> Toma en cuenta que si esta tarea ya tenia eventos  agendadas, ahora aparecerán en tu agenda. Puedes eliminar los recordatorios y establecer fechas nuevas.
		</div>
		<div class = "alert bg-red-mint bg-font-red-mint animated flash" ng-show = "gestionTareaCtrl.avisos.defineFecha()">
			<strong>¡Faltan datos por asignar!</strong>
			Antes de continuar, debes establecer fecha de <b>inicio de la tarea</b>, <b>tiempo de duración aproximada</b> y <b>fecha de cierre tentativo</b>.
		</div>
		<div class = "alert bg-red-mint bg-font-red-mint" ng-show = "gestionTareaCtrl.avisos.atrasoCaso()">
			<strong>¡El caso va atrasado!</strong> La fecha tentativa del precierre del <b>caso</b> ya pasó, procura terminar la tarea lo más pronto posible.
		</div>
		<div class = "alert bg-red-mint bg-font-red-mint" ng-show = "gestionTareaCtrl.avisos.atrasoTarea()">
			<strong>¡Vas atrasado!</strong> La fecha tentativa del cierre de la <b>tarea</b> ya pasó, procura terminar la tarea lo más pronto posible.
		</div>
		<div class = "alert bg-yellow-saffron bg-font-yellow-saffron" ng-show = "gestionTareaCtrl.avisos.excesoTiempo()">
			<strong>¡Te has excedido con el tiempo estimado!</strong> Procura terminar lo antes posible para no atrasar la fecha de precierre del caso.
		</div>
		<div class = "alert alert-info alert-dismissable" ng-show = "gestionTareaCtrl.avisos.ultimaTarea()">
			<button type = "button" class = "close" data-dismiss = "alert" aria-hidden = "true"></button>
			<strong>Última tarea del caso. </strong> Esta es última tarea del caso por concluir, procura terminar dentro de tus fechas establecidas.
		</div>
	</div>
	<div class = "col-md-9">
		<div class = "row">
			<div class = "col-md-3" ng-hide = "gestionTareaCtrl.tarea.fecha_inicio == null">
				<a class = "dashboard-stat dashboard-stat-v2 {{gestionTareaCtrl.tarea.estatus.class}}">
					<div class = "visual">
						<i class = "fa fa-asterisk"></i>
					</div>
					<div class = "details">
						<div class = "number">
							<span>{{gestionTareaCtrl.tarea.estatus.estatus}}</span>
						</div>
						<div class = "desc"> Estatus </div>
					</div>
				</a>
				<a class = "dashboard-stat dashboard-stat-v2 yellow-casablanca">
					<div class = "visual">
						<i class = "fa fa-cogs"></i>
					</div>
					<div class = "details">
						<div class = "number">
							<span>{{gestionTareaCtrl.tarea.avance}}%</span>
						</div>
						<div class = "desc"> Progreso </div>
					</div>
				</a>
				<a class = "dashboard-stat dashboard-stat-v2 blue">
					<div class = "visual">
						<i class = "fa fa-calendar"></i>
					</div>
					<div class = "details">
						<div class = "number">
							<span>{{gestionTareaCtrl.tarea.fecha_tentativa_cierre | amFromUnix | amDateFormat:'D.MMM h:mm a'}}</span>
						</div>
						<div class = "desc"> Fecha de cierre </div>
					</div>
				</a>
				<a class = "dashboard-stat dashboard-stat-v2 purple-seance">
					<div class = "visual">
						<i class = "fa fa-hourglass-start"></i>
					</div>
					<div class = "details">
						<div class = "number">
							<span>{{gestionTareaCtrl.tarea.duracion_tentativa_segundos | duracion:'H:mm':'s'}} horas</span>
						</div>
						<div class = "desc"> Duración </div>
					</div>
				</a>
			</div>
			<div class = "col-md-5">
				<div class = "mt-widget-2">
					<div class = "mt-head" style = "background-image: url(../assets/pages/img/background/32.jpg);">
						<div class = "mt-head-label">
							<button type = "button" class = "btn sbold uppercase btn-outline white">
								<i class = "fa fa-eye"></i>
								Ver cliente
							</button>
						</div>
						<div class = "mt-head-user">
							<div class = "mt-head-user-img">
								<img src = "../assets/pages/img/avatars/team7.jpg"> </div>
							<div class = "mt-head-user-info">
								<span class = "mt-user-name">{{gestionTareaCtrl.caso.cotizacion.contacto.nombre}}</span>
								<span class = "mt-user-time bold">
									 {{gestionTareaCtrl.caso.cliente.razonsocial}}
								</span>
							</div>
						</div>
					</div>
					<div class = "mt-body bg-white">
						<h3 class = "mt-body-title uppercase"> {{gestionTareaCtrl.tarea.titulo}} </h3>
						<p class = "mt-body-description text-justify" style = "padding: 0 50px"> {{gestionTareaCtrl.tarea.descripcion}} </p>
						
						<div class = "mt-body-actions">
							<div class = "btn-group btn-group btn-group-justified">
								<a href = "mailto:{{gestionTareaCtrl.caso.cotizacion.contacto.email}}" class = "btn">
									<i class = "fa fa-envelope-o"></i> {{gestionTareaCtrl.caso.cotizacion.contacto.email}}
								</a>
								<a href = "tel:{{gestionTareaCtrl.caso.cotizacion.contacto.telefono}}" class = "btn ">
									<i class = "fa fa-phone"></i> {{gestionTareaCtrl.caso.cotizacion.contacto.telefono | telefono}}
								</a>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class = "col-md-4">
				<div class = "portlet light ">
					<div class = "portlet-title">
						<div class = "caption">
							<i class = "icon-bubble"></i>
							<span class = "caption-subject font-hide bold uppercase">Chat del caso</span>
						</div>
					</div>
					<div class = "portlet-body" id = "chats">
						<div class = "scroller" style = "height: 380px;" data-always-visible = "1" data-rail-visible1 = "1">
							<ul class = "chats" ng-repeat = "mensaje in gestionTareaCtrl.mensajesChat">
								<li ng-class = "{'out': mensaje.ejecutivo.id != gestionTareaCtrl.usuarioActual.id, 'in': mensaje.ejecutivo.id == gestionTareaCtrl.usuarioActual.id}">
									<img class = "avatar" alt = "" src = "../assets/layouts/layout2/img/avatar2.jpg"/>
									<div class = "message">
										<span class = "arrow"> </span>
										<span class = "name font-{{mensaje.ejecutivo.class}}">{{mensaje.ejecutivo.rol}} | <b>{{mensaje.ejecutivo.nombre}}</b></span>
										<span class = "datetime font-grey-salsa" am-time-ago = "mensaje.timestamp | amFromUnix"></span>
										<span class = "body"> {{mensaje.mensaje}} </span>
									</div>
								</li>
							</ul>
						</div>
						<div class = "chat-form">
							<div class = "input-cont">
								<input class = "form-control" type = "text" id = "mensaje" placeholder = "Escribe tu mensaje..."/>
							</div>
							<div class = "btn-cont">
								<span class = "arrow"> </span>
								<a href = "" class = "btn blue icn-only" ng-click = "gestionTareaCtrl.chat.enviar()">
									<i class = "fa fa-check icon-white"></i>
								</a>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
		<br>
		<div class = "row">
			<div class = "col-md-5">
				<div class = "portlet light" id = "registro-tiempos" ng-hide = "gestionTareaCtrl.tarea.fecha_inicio == null">
					<div class = "portlet-title">
						<div class = "caption">
						<i class = "icon-puzzle font-grey-gallery"></i>
						<span class = "caption-subject bold font-grey-gallery uppercase"> Registro de tiempos</span>
						</div>
					</div>
					<div class = "portlet-body">
						<button class = "btn green-jungle btn-block btn-lg uppercase bold" ng-show = "!gestionTareaCtrl.trabajaTarea.tarea.estaTrabajando" ng-click = "gestionTareaCtrl.trabajaTarea.trabajar()">
							<i class = "fa fa-play"></i>&nbsp;&nbsp;Trabajar en la tarea
						</button>
						<button class = "btn red-thunderbird btn-block btn-lg uppercase bold" ng-show = "gestionTareaCtrl.trabajaTarea.tarea.estaTrabajando" ng-click = "gestionTareaCtrl.trabajaTarea.detener()">
							<i class = "fa fa-stop"></i>&nbsp;&nbsp;Detener avance
						</button>
						<hr>
							<span class = "text-center uppercase" ng-show = "gestionTareaCtrl.trabajaTarea.tarea != null">
							<h5>Sesión actual:</h5>
							<h1 class = "bold">
								<span>{{gestionTareaCtrl.trabajaTarea.tarea.duracionMilis | duracion:'HH:mm:ss':'ms'}}</span>
							</h1>
						</span>
						<hr>
						<span class = "text-center uppercase">
							<h5>Duración total: </h5>
							<h1 class = "bold">{{gestionTareaCtrl.tarea.duracion_real_segundos | duracion:'HH:mm:ss':'s'}}</h1>
						</span>
						<h5 class = "text-center" ng-show = "gestionTareaCtrl.tarea.duracion_real_segundos > gestionTareaCtrl.tarea.duracion_tentativa_segundos">
							<p class = "font-red-thunderbird uppercase bold">
								<i class = "fa fa-warning"></i>
								Te has excedido.
							</p>
						</h5>
						<hr>
						<h5 ng-show = "gestionTareaCtrl.tarea.tiempos.length == 0" class = "bold text-center">Aún no hay sesiones registradas.</h5>
						<table class = "table table-hover table-light" ng-show = "gestionTareaCtrl.tarea.tiempos.length > 0">
							<thead>
								<tr class = "uppercase">
									<th> # </th>
									<th> Fechas </th>
									<th> Duración </th>
								</tr>
							</thead>
							<tbody>
								<tr ng-repeat = "sesion in gestionTareaCtrl.tarea.tiempos">
									<td> {{$index +1}} </td>
									<td><b>{{sesion.fechaInicio | amFromUnix | amDateFormat:'DD/MMM h:mm a'}}</b> a <b>{{sesion.fechaFin | amFromUnix | amDateFormat:'h:mm a'}}</b></td>
									<td>
										<span class = "label bg-green-turquoise bg-font-green-turquoise bold">{{sesion.duracionSegundos | duracion:'HH:mm:ss':'s' }}</span>
									</td>
								</tr>
							</tbody>
						</table>
					</div>
				</div>
			</div>
			<div class = "col-md-7">
				<div class = "portlet light" ng-hide = "gestionTareaCtrl.tarea.fecha_inicio == null || gestionTareaCtrl.trabajaTarea.tarea == null || gestionTareaCtrl.tarea.estatus.id == 4">
					<div class = "portlet-title">
						<div class = "caption">
						<i class = "icon-puzzle font-grey-gallery"></i>
						<span class = "caption-subject bold font-grey-gallery uppercase"> Bitácora de eventos</span>
						</div>
					</div>
					<div class = "portlet-body">
						<div ng-hide = "gestionTareaCtrl.tarea.estatus.id == 4">
							<form role = "form" name = "gestionTareaCtrl.notas.formNotas">
							<div class = "form-body">
								<div class = "form-group">
									<textarea class = "form-control" rows = "3" placeholder = "Descripción de la nota" ng-model = "gestionTareaCtrl.notas.form.descripcion" required></textarea>
								</div>
								<div class = "form-group">
									<div class = "mt-radio-inline" style = "padding: 0px">
										<label class = "mt-radio">
											<input type = "radio" name = "tipoNota" id = "tipoNota1" value = "1" checked = "" ng-model = "gestionTareaCtrl.notas.form.tipo" ng-required = "true"> Pública
											<span></span>
										</label>
										<label class = "mt-radio">
											<input type = "radio" name = "tipoNota" id = "tipoNota2" value = "0" ng-model = "gestionTareaCtrl.notas.form.tipo" ng-required = "true"> Privada
											<span></span>
										</label>
									</div>
								</div>
								<div class = "form-group">
									<rzslider rz-slider-model = "gestionTareaCtrl.notas.form.avance"
									          rz-slider-options = "gestionTareaCtrl.notas.sliderOptions"></rzslider>
								</div>
								<div class = "form-group">
									<input type = "file" ngf-select ng-model = "gestionTareaCtrl.notas.form.file" name = "file" ngf-pattern = "'image/*,application/pdf'" ngf-max-size = "2MB" ngf-model-invalid = "errorFile">
									<p class = "help-block"> Tamaño max. de archivo 5MB.  </p>
									<div class = "progress progress-striped" ng-show = "gestionTareaCtrl.notas.form.file != null">
										<div class = "progress-bar progress-bar-info" role = "progressbar" aria-valuenow = "{{gestionTareaCtrl.notas.progress}}" aria-valuemin = "0" aria-valuemax = "100" ng-style = "{width: gestionTareaCtrl.notas.progress+'%'}">
											<span class = "sr-only"> {{gestionTareaCtrl.notas.progress}}% Complete </span>
										</div>
									</div>
								</div>
								<div class = "form-group">
									<button class = "btn green-jungle btn-xs" ladda = "gestionTareaCtrl.notas.loading" data-style = "expand-right" ng-click = "gestionTareaCtrl.notas.guarda()" ng-disabled = "!gestionTareaCtrl.notas.formNotas.$valid">
										<b><i class = "fa fa-plus"></i>  Añade nota</b>
									</button>
								</div>
							</div>
						</form>
						</div>
					</div>
				</div>
				<div class = "portlet light" ng-hide = "gestionTareaCtrl.tarea.fecha_inicio == null || gestionTareaCtrl.tarea.fecha_tentativa_cierre == null || gestionTareaCtrl.tarea.duracion_minutos == 0">
					<div class = "portlet-title">
						<div class = "caption">
							<i class = "fa fa-commenting font-grey-gallery"></i>
							<span class = "caption-subject bold font-grey-gallery uppercase"> Comentario registrados </span>
						</div>
					</div>
					<div class = "portlet-body">
						<div class = "btn-group">
							<button type = "button" class = "btn btn-default blue" ng-click = "gestionTareaCtrl.notas.filtro('todos')">
								<i class = "fa fa-comments-o"></i> Todos
							</button>
							<button type = "button" class = "btn btn-default green-jungle" ng-click = "gestionTareaCtrl.notas.filtro('publicos')">
								<i class = "fa fa-comment-o"></i> Públicos
							</button>
							<button type = "button" class = "btn btn-default red-thunderbird" ng-click = "gestionTareaCtrl.notas.filtro('privados')">
								<i class = "fa fa-comment"></i> Privados
							</button>
						</div>
						<br><br>
						<div class = "mt-element-list">
							<div class = "mt-list-head list-default ext-1" ng-class = "{'blue' : gestionTareaCtrl.notas.tipo == 'todos', 'green-jungle': gestionTareaCtrl.notas.tipo == 'publicos', 'red-thunderbird': gestionTareaCtrl.notas.tipo == 'privados'}">
								<div class = "row">
									<div class = "col-xs-8">
										<div class = "list-head-title-container">
											<h3 class = "list-title uppercase sbold">{{gestionTareaCtrl.notas.titulo}}</h3>
											<div class = "list-date">Un total de {{gestionTareaCtrl.tarea.notas.todas.length}} comentarios.</div>
										</div>
									</div>
									<div class = "col-xs-4">
										<div class = "list-head-summary-container">
											<div class = "list-pending">
												<div class = "list-count badge badge-default ">{{gestionTareaCtrl.tarea.notas.publicas.length}}</div>
												<div class = "list-label">Públicas</div>
											</div>
											<div class = "list-done">
												<div class = "list-count badge badge-default last">{{gestionTareaCtrl.tarea.notas.privadas.length}}</div>
												<div class = "list-label">Privadas</div>
											</div>
										</div>
									</div>
								</div>
							</div>
							<div class = "mt-list-container list-default ext-1">
								<div class = "scroller" style = "height: 380px;" data-always-visible = "1" data-rail-visible1 = "1">
									<ul>
									<li class = "mt-list-item" ng-repeat = "nota in gestionTareaCtrl.notas.lista" ng-attr-id = "{{'nota'+nota.id}}">
										<div class = "list-icon-container">
											<i class = "icon-check"></i>
										</div>
										<div class = "list-datetime">
											<b>Avance</b><br>{{nota.avance}} %
										</div>
										<div class = "list-item-content">
											<h6 class = "uppercase">
												<span class = "label bg-green-jungle bg-font-green-jungle bold" ng-show = "nota.publico"> Pública </span>
												<span class = "label bg-red-thunderbird bg-font-red-thunderbird bold" ng-show = "!nota.publico"> Privada </span>&nbsp;
												 {{nota.creada | amFromUnix | amDateFormat:'DD [de] MMM [a las] hh:mm a'}}
											</h6>
											<small>{{nota.id}}. {{nota.nota}}</small>
											<div ng-show = "nota.archivos.length > 0">
												<hr>
												<h6>Archivos adjuntos:</h6>
												<ul>
													<li ng-repeat = "archivo in nota.archivos">
														<a ng-href = "{{archivo.downloadUrl}}" target = "_blank" class = "btn btn-xs default">
															<i class = "fa" ng-class = "{'fa-file-pdf-o' : archivo.contentType == 'application/pdf', 'fa-file-image-o' : archivo.contentType == 'image/jpeg'}"></i>
															{{archivo.nombre}} | {{archivo.tamano/1000 | number:2}} KB
														</a>
													</li>
												</ul>
											</div>
											<hr>
											<button type = "button" class = "btn red btn-xs" ng-click = "gestionTareaCtrl.notas.elimina(nota)">
												<i class = "fa fa-trash"></i>
											</button>
											<button type = "button" class = "btn blue btn-xs" ng-click = "gestionTareaCtrl.notas.edita(nota)">
												<i class = "fa fa-edit"></i>
											</button>
											<button type = "button" class = "btn green-jungle btn-xs" ng-show = "!nota.publico" ng-click = "gestionTareaCtrl.notas.cambia(nota)">
												<i class = "fa fa-toggle-on"></i>
											</button>
											<button type = "button" class = "btn red-thunderbird btn-xs" ng-show = "nota.publico" ng-click = "gestionTareaCtrl.notas.cambia(nota)">
												<i class = "fa fa-toggle-off"></i>
											</button>
										</div>
									</li>
								</ul>
									<br>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class = "col-md-3">
		<div class = "portlet light" ng-class = "{'animated tada': gestionTareaCtrl.iniciaAnimacion}" ng-show = "gestionTareaCtrl.tarea.fecha_inicio == null || gestionTareaCtrl.tarea.fecha_tentativa_cierre == null || gestionTareaCtrl.tarea.duracion_minutos == 0">
			<div class = "portlet-title">
				<div class = "caption">
					<i class = "fa fa-calendar font-red-thunderbird"></i>
					<span class = "caption-subject bold font-red-thunderbird uppercase"> Fechas programadas</span>
				</div>
			</div>
			<div class = "portlet-body">
				<h5>Otras tareas:</h5>
				<span ng-show = "gestionTareaCtrl.caso.tareas.length == 1 && gestionTareaCtrl.caso.tareas[0].id == gestionTareaCtrl.tarea.id"><b>- Esta es única tarea.</b></span>
				<ol>
					<li ng-repeat = "tarea in gestionTareaCtrl.caso.tareas" ng-hide = "tarea.id == gestionTareaCtrl.tarea.id">
						<b>{{tarea.titulo}}</b> Asignado a {{tarea.ejecutivo.nombre}}
						<ul>
							<li>
								Inicio:
								<span ng-if = "tarea.fecha_inicio == null"> <i>Sin definir por {{tarea.ejecutivo.nombre}}</i> </span>
								<span ng-if = "tarea.fecha_inicio != null">
									<i class = "font-blue-madison">{{tarea.fecha_inicio | amFromUnix | amDateFormat:'D[/]MM[/]YY [a las] h:mm a'}}</i>
								</span>
							</li>
							<li>
								Cierre tentativo
								<span ng-if = "tarea.fecha_tentativa_cierre == null"> <i>Sin definir por {{tarea.ejecutivo.nombre}}</i> </span>
								<span ng-if = "tarea.fecha_tentativa_cierre != null">
									<i class = "font-blue-madison">{{tarea.fecha_tentativa_cierre | amFromUnix | amDateFormat:'D[/]MM[/]YY [a las] h:mm a'}}</i>
								</span>
							</li>
							<li>
								Duración estimada
								<span ng-if = "tarea.duracion_tentativa_segundos == 0"> <i>Sin definir por {{tarea.ejecutivo.nombre}}</i> </span>
								<span ng-if = "tarea.duracion_tentativa_segundos != 0">
									<i class = "font-blue-madison">
										{{tarea.duracion_tentativa_segundos | duracion:'H:mm':'s'}} horas
									</i>
								</span>
							</li>
						</ul>
					</li>
				</ol>
				<hr>
				<form name = "gestionTareaCtrl.fechas.formFechatarea">
					<div class = "form-group">
						<label>Fecha y hora de inicio: </label>
						<div class = "input-group input-group-sm">
							<input type = "text" class = "form-control"
							       datetime-picker = "dd/MM/yyyy H:mm"
							       ng-model = "gestionTareaCtrl.fechas.fechatarea.fechainicio"
							       is-open = "gestionTareaCtrl.fechas.fechainicio.open"
							       datepicker-options = "gestionTareaCtrl.fechas.fechainicio.options"
							       placeholder = "Fecha de inicio"
							       readonly
							       required>
							<span class = "input-group-btn">
								<button class = "btn green bold" type = "button" ng-click = "gestionTareaCtrl.fechas.fechainicio.openCalendar()">
									<i class = "fa fa-calendar"></i>
								</button>
							</span>
						</div>
					</div>
					<div class = "form-group">
						<label>Duración de la tarea en horas: </label>
						<div class = "input-icon input-icon-sm right">
							<i class = "fa fa-clock-o"></i>
							<input type = "text" class = "form-control input-sm"
							       ng-model = "gestionTareaCtrl.fechas.fechatarea.duracion"
							       placeholder = "00:00"
							       mask = "9?99:59"
							       restrict = "reject"
							       validate = "true"
							       required>
						</div>
					</div>
					<div class = "form-group">
						<label>Fecha y hora tentativa de cierre: </label>
						<div class = "input-group input-group-sm">
							<input type = "text" class = "form-control"
							       datetime-picker = "dd/MM/yyyy H:mm"
							       ng-model = "gestionTareaCtrl.fechas.fechatarea.fechacierre"
							       enable-time = "true"
							       is-open = "gestionTareaCtrl.fechas.fechacierre.open"
							       datepicker-options = "gestionTareaCtrl.fechas.fechacierre.options"
							       placeholder = "Fecha tentativa cierre"
							       readonly
							       required>
							<span class = "input-group-btn">
								<button class = "btn green bold" type = "button" ng-click = "gestionTareaCtrl.fechas.fechacierre.openCalendar()">
									<i class = "fa fa-calendar"></i>
								</button>
							</span>
						</div>
					</div>
					<button class = "btn green-turquoise btn-block bold uppercase"
					        ng-click = "gestionTareaCtrl.fechas.abreAgenda()"><i class = "fa fa-calendar"></i>  Ver mi agenda
					</button>
					<button class = "btn green-sharp btn-block bold uppercase"
					        ng-click = "gestionTareaCtrl.fechas.guarda()"
					        ng-disabled = "!gestionTareaCtrl.fechas.formFechatarea.$valid">Establecer fechas
					</button>
				</form>
			</div>
		</div>
		<div class = "portlet light">
			<div class = "portlet-title">
				<div class = "caption">
					<i class = "icon-puzzle font-grey-gallery"></i>
					<span class = "caption-subject bold font-grey-gallery uppercase"> Caso No. {{gestionTareaCtrl.caso.id}}</span>
				</div>
				<div class = "actions">
					<button class = "btn btn-circle btn-icon-only btn-default" ng-click = "gestionTareaCtrl.reloadCaso()">
						<i class = "fa fa-refresh"></i>
					</button>
					<a class = "btn btn-circle btn-icon-only btn-default fullscreen" href = "javascript:;" data-original-title = "" title = ""> </a>
				</div>
			</div>
			<div class = "portlet-body">
				<div class = "row">
					<div class = "col-md-4">
						<dt>Lider</dt>
						<dd>{{gestionTareaCtrl.caso.lider.nombre}}</dd>
					</div>
					<div class = "col-md-4">
						<dt>Avance</dt>
						<dd>{{gestionTareaCtrl.caso.avance}} %</dd>
					</div>
					<div class = "col-md-4">
						<dt>Estatus</dt>
						<span class = "badge bg-{{gestionTareaCtrl.caso.estatus.class}} bold"> {{gestionTareaCtrl.caso.estatus.estatus}} </span>
					</div>
				</div>
				<br>
				<div class = "row">
					<div class = "col-md-12">
						<dt>Fecha tentativa de precierre: </dt>
						<dd ng-if = "gestionTareaCtrl.caso.fecha_tentativa_precierre == null">Aún sin calcularse.</dd>
						<dd ng-if = "gestionTareaCtrl.caso.fecha_tentativa_precierre != null">
							<h5>
								{{gestionTareaCtrl.caso.fecha_tentativa_precierre | amFromUnix | amDateFormat:'DD [de] MMM [del] YY [a las] h:mm a'}}
								<small class = "font-green-jungle bold" ng-show = "!gestionTareaCtrl.avisos.terminoCaso()" am-time-ago = "gestionTareaCtrl.caso.fecha_tentativa_precierre | amFromUnix"></small>
								<small class = "font-red-thunderbird bold" ng-show = "gestionTareaCtrl.avisos.terminoCaso()"> Debió terminar <span am-time-ago = "gestionTareaCtrl.caso.fecha_tentativa_precierre | amFromUnix"></span></small>
							</h5>
						</dd>
					</div>
				</div>
				<hr>
				<div class = "row">
					<div class = "col-md-12">
						<h5 class = "bold">Tareas:</h5>
						<ul class = "list-group">
							<li class = "list-group-item" ng-repeat = "tarea in gestionTareaCtrl.caso.tareas" ng-class = "{'bg-grey-steel bg-font-grey-steel': tarea.id == gestionTareaCtrl.tarea.id}">
								<b ng-show = "tarea.avance < 100">{{tarea.titulo}}</b>
								<del ng-show = "tarea.avance == 100" class = "bold">{{tarea.titulo}}</del>
								<br>
								 <span>{{tarea.ejecutivo.nombre}}</span>
								<span class = "badge bg-{{tarea.ejecutivo.class}}"> <b>{{(tarea.avance)}} %</b> </span>
							</li>
						</ul>
					</div>
				</div>
				<hr>
				<button class = "btn blue btn-block" ng-click = "gestionTareaCtrl.vistaCaso()"><b>Vista del caso</b></button>
			</div>
		</div>
		<div class = "portlet light" id = "miagenda">
					<div class = "portlet-title">
						<div class = "caption">
							<i class = "fa fa-calendar font-grey-gallery"></i>
							<span class = "caption-subject bold font-grey-gallery uppercase"> Añadir a mi agenda</span>
						</div>
						<div class = "actions">
							<button class = "btn btn-circle btn-icon-only btn-default" ng-click = "gestionTareaCtrl.agenda.reloadAgenda()">
								<i class = "fa fa-refresh"></i>
							</button>
						</div>
					</div>
					<div class = "portlet-body">
						<form name = "gestionTareaCtrl.agenda.formFechaAgenda">
							<div class = "form-group">
								<label>Fecha y hora: </label>
								<div class = "input-group input-group-sm">
									<input type = "text" class = "form-control"
									       datetime-picker = "dd/MM/yyyy HH:mm"
									       ng-model = "gestionTareaCtrl.agenda.fechaInicio"
									       is-open = "gestionTareaCtrl.agenda.open"
									       datepicker-options = "gestionTareaCtrl.agenda.options"
									       placeholder = "Fecha de inicio"
									       readonly
									       required>
									<span class = "input-group-btn">
										<button class = "btn green bold" type = "button" ng-click = "gestionTareaCtrl.agenda.openCalendar()">
											<i class = "fa fa-calendar"></i>
										</button>
									</span>
								</div>
							</div>
							<div class = "form-group">
								<label>Duración: </label>
								<div class = "input-icon input-icon-sm right">
									<i class = "fa fa-clock-o"></i>
									<input type = "text" class = "form-control input-sm"
									       ng-model = "gestionTareaCtrl.agenda.duracion"
									       placeholder = "00:00"
									       mask = "9?99:59"
									       restrict = "reject"
									       validate = "true"
									       required>
								</div>
							</div>
							<button class = "btn green-sharp btn-block bold uppercase"
							        ng-click = "gestionTareaCtrl.agenda.guarda()"
							        ng-disabled = "!gestionTareaCtrl.agenda.formFechaAgenda.$valid"> Añadir a mi agenda
							</button>
						</form>
						<hr>
						<h6>Mis recordatorios: </h6>
						<b ng-show = "gestionTareaCtrl.recordatorios.length == 0">- No hay recordatorios.</b>
						<div class = "table-scrollable table-scrollable-borderless" ng-show = "gestionTareaCtrl.recordatorios.length > 0">
							<table class = "table table-hover table-light">
								<thead>
									<tr class = "uppercase">
										<th> Fecha y hora </th>
										<th></th>
									</tr>
								</thead>
								<tbody>
									<tr ng-repeat = "recordatorio in gestionTareaCtrl.recordatorios">
										<td> {{recordatorio.start | amFromUnix | amDateFormat:'DD [de] MMM [de] h:mm a'}} a {{recordatorio.end | amFromUnix | amDateFormat:'h:mm a'}}</td>
										<td>
											<button class = "btn btn-xs red-thunderbird" ng-click = "gestionTareaCtrl.agenda.elimina(recordatorio.id)">
		                                                                                <i class = "fa fa-trash-o"></i>
		                                                                        </button>
										</td>
									</tr>
								</tbody>
							</table>
						</div>
						<hr>
						<button class = "btn green-turquoise btn-block bold uppercase"
						        ng-click = "gestionTareaCtrl.agenda.abreAgenda()"><i class = "fa fa-calendar"></i>  Ver mi agenda
						</button>
					</div>
				</div>
		<div class = "portlet light">
			<div class = "portlet-title">
				<div class = "caption">
					<i class = "fa fa-refresh font-red"></i>
					<span class = "caption-subject bold font-red uppercase"> Cambiar estatus</span>
				</div>
			</div>
			<div class = "portlet-body">
				<form name = "gestionTareaCtrl.agenda.formFechaAgenda">
					<div class = "form-group">
						<label class = "bold">Cambia estatus</label>
						<div class = "form-group">
							<select
								class = "form-control input-lg"
								ng-options = "estatus.id as estatus.estatus for estatus in gestionTareaCtrl.cambiaEstatus.estatus"
								ng-change = "gestionTareaCtrl.cambiaEstatus.actuliza()"
								ng-model = "gestionTareaCtrl.cambiaEstatus.estatusNuevo">
							</select>
						</div>
					</div>
				</form>
			</div>
		</div>
	</div>
</div>

<script type = "text/ng-template" id = "modalVistaAgenda.html">
	<div class = "modal-header">
		<button type = "button" class = "close" aria-hidden = "true" ng-click = "modalVistaAgenda.cancel()"></button>
		<h4 class = "modal-title font-green-sharp"><i class = "fa fa-calendar"></i> Mi agenda </h4>
	</div>
	<div class = "modal-body">
		<div class = "row">
			<div class = "col-md-12">
				<div ui-calendar = "modalVistaAgenda.uiConfig.calendar" class = "span8 calendar" ng-model = "modalVistaAgenda.eventSources2"></div>
			</div>
		</div>
	</div>
	<div class = "modal-footer">
		<button class = "btn grey-mint btn-outline" ng-click = "modalVistaAgenda.cancel()">Cancelar</button>
	</div>
</script>
